---
title: HTTP
author: nirgn
layout: post
summary: ""
category: Stuff
---
HTTPבפוסט הזה נדבר על הפרוטוקול HTTP. נראה למה הוא משמש, איך הוא עובד.

מידע כללי
מבנה בקשה - תגובה
עוגיות (Cookies)
כותרות (Headers fields)
מתודות (Methods)


1. מידע כללי

HTTP אלה ראשי תיבות של Hypertext Transfer Protocol. אז נתחיל במילה הראשונה, Hypertext, הוא טקסט המוצג על גבי מסך מחשב (או כל מכשיר אלקטרוני אחר) עם התייחסויות (Hyperlinks) לטקסטים אחרים אליהם הקורא יכול לגשת. מסמכי ה Hypertext מקושרים בינהם ע"י קישורים (Links), ולמרות שהשם מתייחס רק לטקסט ה Hypertext מסוגל להציג גם תמונות, טבלאות , וטפסים. ה Hypertext הוא הקונספט שבבסיס ההגדרת המבנה של ה World Wide Web  (או WWW), כאשר הדפים נכתבים בשפת HTML (ראשי תיבות של Hypertext Markup Language).

Transfer מייצג את ההעברה של המידע על גבי רשת (במקרה שלנו ה World Wide Web). וה Protocol (פרוטוקול) (במקרה של מדעי המחשב) זהו מסמך המכיל סדרת חוקים רשמיים, במקרה שלנו (של HTTP) מדובר על סדרת חוקים לשידור או החלפה של מידע ברשת.

החדשות הטובות הן, שאתם יודעים על מה מדובר, השתמשתם בפרוטוקול הזה אין ספור פעמים. כל פעם שאתם ניגשים לאתר, אתם כותבים http://www.google.com אתם משתמשים בפרוטוקול HTTP על מנת לגשת לאתר www.google.com (לרוב, כמו במקרה של chrome, הדפדפן יסתיר מכם את הפרוטוקול כשמדובר ב http).



2. מבנה בקשה - תגובה

Screenshot 2015-06-16 at 21.24.46בפועל מדובר על לקוח (Client) ששולח בקשה (Request) לשרת (Server) והשרת עונה בתגובה (Response). הדוגמה הפשוטה ביותר ל Client היא הדפדפן, אך אנו יכולים גם לפתוח שורת פקודה ולשלוח Request לשרת כלשהו. בשביל הדוגמה הנוכחית נשתמש בתוכנה בשם cURL (תוכנה הנותנת יכולת העברת מידע באמצעות מגוון פרוטוקולים רחב דרך שורת הפקודה, הספרייה תומכת במגוון גדול מאוד של פרוטוקולים ופועלת על רוב הפלטפורמות הקיימות), במידה והיא לא מותקנת אצלכם ניתן להוריד אותה מכאן. אנחנו יכולים לכתוב בשורת הפקודה curl -v http://wikipedia.org כדי לקבל את את הוקבץ HTML הראשי מהשרת, ולפי ה manual שלהם, אם נשתמש בדגל v- (נוסיף אותו אחרי ה curl) נקבל מידע על הבקשה בפורמט מסודר וקריא (מה שניתן לראות בתמונה למעלה משמאל).

הכוכביות משמשות באופן דומה להערות (Comments - //), והוא בעצם אומר שהוא בנה מחדש את הכתובת ששלחתי לו, ניסה להתחבר, והתחבר לכתובת. ולאחר מכן, בשורה הראשונה (המתחילה ב <), ישנה הפקודה הראשונה, הפרוטוקול שנשלח. והחלק הראשון, GET, היא המתודה, אח"כ זה הנתיב (/ זה השורש), ואח"כ מצויין מס' הגרסה של הפרוטוקול (HTTP/1.1). לאחר מכן יש מידע בצורה של Key / Value Pair. ה Host מייצג את מי שאנחנו מבקשים ממנו את הבקשה ובמקרה שלנו זה wikipedia.org, ה User-Agent מייצג את מי מבצע את הבקשה ובמקרה שלנו זה curl/7.42.1, וה Accept מייצג את מה שקיבלנו ובמקרה שלנו זה */* שלפי הדוקומנטציה של הפרוטוקול ניתן לראות שזה אומר שקיבלנו את כל הסוגים והתת סוגים של קבצי המדיה.

עכשיו אנחנו עוברים לחלק של השרת בפרוטוקול, הוא מקבל את הבקשה של הלקוח, וכנראה שיושב שם סוג של שרת Apache שאחראי להגיד משהו כמו 'אני יודע על מה אתה מדבר, אני אשלח לך את זה' והתגובה של השרת (Response) נמצאת בהמשך החלון של שורת הפקודה בתמונה משמאל, כשאנו יכולים להבדיל בין הבקשה לתגובה לפי החיצים בתחילת כל שורה. הדבר הראשון שאנו רואים בתגובה זה מס' הגרסה של HTTP, ולאחריו את ה status code (נרחיב עליהם בהמשך).

לאחר מכן השרת שולח את סדרת ערכי הכותרת שלו (Header Values) כמו

סוג השרת (Server) שבמקרה הזה הוא Varnish.
כמות התוכנת (Content-Length) שבמקרה הזה היא 0 (מתחתיו אפשר לראות את הסוג, שזה bytes).
כל הכותרות עם Xים הם נסיוניים (חלקם אומנם ניסיוניים אבל הם כך במשך המון המון זמן, אז אפשר לצפות, ולפעמים זה אפילו כבר סטדנרט בתעשייה שהם יהיו שם).
עם Set-Cookie מגדירים את העוגיות הנשמרות בצד הלקוח.
וזהו, הפרוטוקול הסתיים. הלקוח ביצע את הבקשה, השרת החזיר תגובה, והתקשורת בינהם הסתיימה. כעת אם נבצע בקשה נוספת אל מול אותו שרת, אין לו מושג מי היינו (קונספט הנקרא Stateless) והוא מחזיר את התשובה כאילו זאת הפעם הראשונה שאנו שולחים את הבקשה.



REST .3

מערכת היחסים לקוח / שרת היא תנאי הכרחי למערכת עקרונות הנקראת REST (או Representational State Transfer). בכל פעם שאנו לוחצים על קישור באינטרנט, אנו עוברים למצב (State) חדש, מה שמביא אותנו לדף הבא. ע"י ביצוע מודל זה (לחיצה מדף לדף) אנחנו מתחילים לעקוב אחרי עקרונות REST, וכשמשהו עוקב אחרי עקרונות אלו הוא נקרא RESTful.

API הוא ראשי תיבות של Application Programming Interface, ז"א ש RESTful API הוא חוזה בקוד. החוזה מתאר את הדרך בה תוכנה כלשהי מבצעת אינטראקציה עם תוכנה אחרת. לדוגמה, אם אנו רוצים לבצע אינטראקציה עם טוויטר, אנחנו צריכים להשתמש ב API של טוויטר, שיתאר את התהליך לבצע אימות  משתמשים, לייבא כתובות URL, פונקציות וכד'.

כשאר ה API הוא RESTful הוא:

מפריד בין הלקוח לשרת.
לא מחזיק (/שומר) מידע בין בקשות. כלומר כל המידע הדרוש כדי להגיב לבקשה הנו תמיד זמין בכל בקשה (ז"א מסופק ע"י טוויטר בכל בקשה מחדש).
משתמש בפרוטוקול HTTP ובמתודות של הפרוטוקול.
* יש עוד כמה דרישות, אך אלה הן העקריות.



3. עוגיות (Cookies)

עוגיות הן קבצי מידע המכילות מחרוזות של אותיות ומספרים ומשמשות לאימות ומעקב אחר המשתמש. ז"א לא מעקב בסגנון FBI וכד', אלה כדי לזהות אותך מול אתר מסויים. כמו שאמרנו, פרוטוקול ה HTTP עובד בצורת Stateless ז"א שכל בקשה-תגובה הן נפרדות ואינן תלויות. לכן בהרבה מקרים, בזמן יצירת הקשר (בקשה - Request) השרת יוצר מחרוזת ומבקש מהמחשב של הלקוח לשמור אותה. בכל פעם שההלקוח (הדפדפן) יוצר קשר נוסף עם השרת המחרוזת מוחזרת חזרה לשרת על מנת שהוא בתורות יכול לזהות את המשתמש ולאחזר מידע שנשמר בינהם.





4. כותרות (Headers fields)

ניתן לראות את כל סוגי הכתורת כאן.





5. מתודות (Methods)

לתקן HTTP יש כמה מתודות, חלק הוגדרו בגרסה 1.0 והחלקן נוספו בגרסה 1.1, אך אלה שנראה לרוב הם:

GET - מחזיר מידע ממקור ספציפי (ראינו אותה למעלה).
POST - שולח מידע חדש למקור ספציפי.
PUT - מעדכן מידע קיים במקור ספציפי.
DELETE - מסיר מידע קיים במקור ספציפי.
בקשת HTTP מורכבת מ-3 חלקים: request line שאומרת לשרת איזה סוג בקשה נשלח (GET, POST וכד') ואיזה מידע אנחנו מחפשים (יצויין בהמשך כתובת האתר), ה header ששולח לשרת מידע נוסף (כמו איזה לקוח מבצע את הבקשה, סוג התוכן המבוקש, וכ'ו), וה body שבמקרה של GET הוא ריק (אך במקרים אחרים יכול להכיל מידע, כמו בבקשת POST או PUT בהם אנו מתעסקים עם מידע).



בקשה מוצלחת לשרת תספק תוצאה בדמות תשובה אותה השרת ישלח אלינו, ללקוח. כחלק מהתשובה שנקבלת מהשרת, יהיה קוד בן 3 ספרות, מ-1 עד 5. כאשר כל קוד מייצג משהו שונה.  הקודים מחולקים למשפחות, וכל ספרה ראשונה (ספרת המאות) מייצגת משפחה שונה (לא אעבור על הקודים באופן מפורט יותר מאשר ספרת המאות, לכן את הרשימה המלאה ניתן למצוא, בין היתר, בוויקיפדיה).

1xx: השרת מעדכן כי יש לו את מה שביקשת והוא עובד על הבקשה. במהירות של היום הודעות אלו לא נראות כלל.
2xx: באופן כללי הודעות אלה מגיעות כאשר השרת מאשר כי הבקשה עובדה באופן תקין והכל בסדר. דוגמה לקוד מהמשפחה הזו הוא 200, שקיבלנו בדוגמה למעלה כאשר שלחנו בקשה לוויקיפדיה.
3xx: הודעות אלה באופן כללי מעידות על כך שהשרת מסוגל לבצע את הבקשה שלנו אך היא מחכה בתור (כי הוא צריך לעשות משהו לפני, כמו לדוגמה אם השתמשנו בכתובת ישנה והוא צריך לנתב את הבקשה שלנו).
4xx: המשפחה הזאת מייצגת הודעות שגיאה. המפורסם מבינהם הוא 404.
5xx: משפחה זו מייצגת הודעות שגיאה בהם קרתה שגיאה בשרת והוא פישל, ז"א לא מצליח להגיב לבקשה.
var message = new XMLHttpRequest();
message.open("GET", "http://www.google.com/doesnt_exist", false);
message.send();
console.log(message.status);
בשורה הראשונה אני יוצא אובייקט HTTP בשם message. בשורה השניה אני פותח את האובייקט ומכניס לתוכו את המשתנים הרלוונטים. בשורה השלישית האובייקט - בקשה נשלח. ובהודעה הרביעית אני מדפיס את הסטטוס של הבקשה - ז"א הקוד.









תקן HTTP גרסה 1.0 הגדיר 3 מתודות: GET לקיראה, POST למשהו, ו HEAD למשהו

גרסה 1.1 של התקן הוסיפה מתודות נוספות: OPTIONS למשהו, PUT למשהו, DELETE למשהו, TRACE למשהו, CONNECT למשהו.



במידה ואתם רוצים לבדוק את הדברים בעצמכם אני ממליץ על האתר httpbin.org כדי להתנסות. בצד שמאל ניתן לראות שלחצתי על הקישור "image/" ובתיאור כתוב ".Returns page containing an image" ואפשר לראות את ההכותרות שקיבלתי חזרה, ו



HTTP/1.0 הגדיר את המתודות הבאות:

GET - קריאת ה resource.
POST - עדכון ה resource.
HEAD - כמו GET רק ללא קבלת ה body, שזו סוג של "סימולציה" מה היה קורה לו היינו קוראים ל GET. טוב לבדיקה אם URL הוא תקין, למשל.
תקן HTTP/1.1 הגדיר מתודות נוספות:

OPTIONS - בקשת מידע על הפעולות האפשריות על המשאב.
PUT - שמירה של מידע כמשאב ב URL המסופק.
DELETE - מחיקה של המשאב. כנראה שאתם צריכים הרשאות מתאימות בכדי לעשות זאת.
TRACE - תאורטית משמשת ל debug, אולם בפועל לא כ"כ בשימוש בגלל סכנות אבטחה שבשימוש בה.
CONNECT - מתודה טכנית שנועדה לתמוך ב HTTP Tunneling.
