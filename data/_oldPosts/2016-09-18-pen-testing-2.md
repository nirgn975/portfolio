---
title: חלק 2
author: nirgn
layout: post
summary: ""
category: Pen Testing
---
בפוסט נמשיך ללמוד על נושא האנונימיות לעומק. בנוסף, אציין כי החלק הזה הינו המשך ישיר לחלק הקודם, נמשיך מאותו המקום, עם אותן דוגמאות וכד'. הסדרה מהווה סוג של יומן מסע המתעד את תהליך הלמידה שלי את עולם ה Pen Testing ממקום שאינו פורמלי ומתבצע דרך חיפוש באינטרנט, קריאת ספרים ומאמרים, צפייה ב Youtube, וחקירה אישית.

תוכן עיניינים:

Proxy Chain
VPN
שלוש
ארבע
חמש


Proxy Chain

שרשרת פרוקסי (Proxy Chain) היא הפעולה של הגדרת התעבורה דרך מספר שרתי פרוקסי, וזאת על מנת לחזק את האנונימיות שלנו (הרי אף פעם לא ניהיה אנונימיים ב 100%, ואסור לנו לסמוך על כך. לכן עלינו להפוך את פעולת האיתור לקשה יותר במידה ומישהו ינסה לבצע זאת). לכן כעת נגדיר שרשרת פרוקסי (Proxy Chain) שתעבוד ביחד עם Tor. יש לציין כי נגדיר את המערכת כך שכל התעבורה תעבור דרך שרשרת הפרוקסי ולא רק התעבורה של הדפדפן (Browser) שלנו.

proxychains-confנבצע את שרשור הפרוקסים עם תוכנה בשם Proxifier המגיעה כבר עם Kali, וכדי לעשות זאת נערוך את קובץ ההגדרות שלה, הנקרא proxychains ע"י כתיבת הפקודה 'sudo nano /etc/proxychains.conf' בטרמינל (Terminal) עם עורך טקסט בשם Nano (המגיע גם הוא מותקן עם Kali, והאמת שעם רוב הפצות ה Linux) (בגלל שכתבנו sudo לפני הפקודה תידרשו להכניס את הסיסמה שלכם ורק אז יפתח הקובץ, עשינו זאת בשביל לקבל הרשאות Root כדי שנוכל לערוך את הקובץ). התוכנה יכולה לבצע את התקשורת עם פרוטוקול HTTP, SOCKS4, SOCKS5 ומומלץ להשתמש ב SOCKS5 בלבד. HTTP זה הפרוטוקול המוכר לכולם (אם לא, Wikipedia is your friend) ומיועד לתעבורת HTTP, פרוטוקול SOCKS מבצע תעבורה של חבילות מידע בין שרת ללקוח דרך שרת פרוקסי, גרסה 5 של אותו פרוטוקול מוסיפה את האפשרות לאימות, ל IPv6, ול QDP (ולכן נשתמש בגרסה זו).

אחרי שכתבנו את הפקודה, נפתח לנו הטקסט (של הקובץ) בטרמינל ואנו יכולים לערוך אותו (תמונה משמאל). למי שחדש בנושא: (בקצרה) כל שורה המתחילה ב # (סולמית) הינה הערה (comment) והמערכת אינה מפרשת אותה. בין חלקי הטקסט (הערות) נראה מילים / משפטים המתארים פקודות שיקבעו כיצד אנו רוצים שהתעבורה שלנו תנותב, הראשון הוא dynamic_chain ומתחתיו ישנו תיאור של הפקודה.

מעל dynamic_chain אנו רואים שישנו טקסט שאומר לנו כי האופציות מתחתיו יתארו כיצד שרשרת הפרוקסי מתנהגת, ורק אופציה אחת יכולה להיות מופעלת (ז"א לא בהערה). ז"א ששרשרת הפרוקסי שלנו יכולה להיות אם dynamic_chain או static_chain. כאשר dynamic_chain אומר שכל חיבור יעשה דרך שרשור פרוקסים, וסדר השרשור יעשה על פי הסדר שבו הם מופיעים ברשימה, והמערכת תדלג על פרוקסים מתים, כך שלפחות פרוקסי אחד צריך להיות פעיל על מנת שהתעבורה תתבצע. בעוד static_chain אומר שכולם צריכים להיות פעילים, המערכת לא תדלג על פרוקסים מתים. מכיוון שאני מתכנן להשתמש בפרוקסים חינמים וסביר להניח שכמה מהם יפלו במהלך התקופה, אוציא את dynamic_chain מהערה, ואכניס את strict_chain להערה במקומו.

random_chain אומר שכל חיבור עם proxy chain יעשה באופן רדנומלי ולא על פי הסדר של הפרוקסים שנקבעו ברשימה. ז"א שאם כתבו את הפרוקסים a,b,c. בחיבור אחד השרשור יהיה a->b->c ובחיבור שני השרשור יכול להיות c->a->b. ומתחתיו אפשר גם לשנות את אורך השרשור (chain_len) כך שאם כתבנו ברשימה 5 פרוקסים, והאורך שהגבלנו את המערכת הוא 3 אז חיבור אחד יכול להיות a->b->d. וחיבור שני יהיה c->b->e.

לאחר מכן יש את quiet_mode שלצערי לא הצלחתי להבין מהו. ואת proxy_dns שמגן עלינו מפני הדלפות מידע משרתי DNS (או DNS leak) וצריך להיות פעיל (לא בהערה). הדלפות DNS אומר שגם אם הצלחנו להסתיר את הכתובת ה IP שלנו עדיין יש את כתובת ה IP של שרת ה DNS שאנו משתמשים ומשם אפשר לאתר את כתובת ה IP שלנו (למי שרוצה לקרוא יותר על כיצד פותרים את הבעיה הזו לחצו כאן. בגודל פשוט משתמשים בשרתי DNS אנונימיים, הם אולי יותר איטיים אבל לא שומרים log-ים). לאחר מכן יש הגדרת זמן ל Timeout, ואז דוגמאות לכיצד לכתוב את רשימת הפרוקסים.



d-cain_terminalכפי שניתן לראות בדוגמאות, בעמודה הראשונה אנו מכניסים את סוג הפרוטוקול, לאחר מכן את כתובת ה IP שלו, אחר כך את מספר הפורט ששרת הפרוקסי מאזין לו (דרכו אנו מתחברים לשרת הפרוקסי), ולבסוף את שם המשתמש (אם יש) ואז את הסיסמה (אם יש). כשנירד קצת מתחת אנו רואים את שרת הפרקוסי הראשון שלנו, הדיפולטיבי שהוגדר ע"י Tor. הוא משתמש בפרוטוקול socks4, כתובת ה IP המקומית (local loop - 127.0.0.1), ודרך פורט 9050. ז"א שכל התעבורה במחשב שלנו עוברת דרך הפורט הזה שאליו Tor מאזין. אני אוסיף בדיוק את אותם פרטים רק עם socks5 מתחתיו, כדי שהתעבורה תעבור דרך Tor אך בפרוטול socks5 (בדקתי באינטרנט לפני כן ש Tor אכן תומך בפרוטוקול הזה), ונלחץ ctrl+o כדי לשמור, ואז ctrl+x כדי לצאת.


dns_leak_testלאחר מכן נבדוק את הסטטוס של tor עם הפקודה 'service tor status', נקבל תשובה שהוא לא פועל ('!tor is not running ... failed'), ואז נפעיל את tor עם הפקודה 'service tor start'. הדבר הבא שאנחנו צריכים לעשות הוא להשתמש בשרשור פרוקסי עם tor ודפדפן האינטרנט הקיים ב kali. נבצע זאת עם הפקודה 'proxychains firefox www.duckduckgo.com' (אנו כותבים firefox כי זה דפדפן ברירת המחדל של kali, כן למרות שכתוב Iceweasel, מכיוון שהוא פוצל מפרוייקט Firefox, ובמקום הכתובת של duckduckgo אתם יכולים לשים איזה כתובת שתבחרו - זה רק למטרות בדיקה, שוב, לא נגלוש דרך root). יפתח לנו הדפדפן, ובשורת החיפוש נכתוב "check for dns leak" וניכנס לאתר בשם "DNS leak test". שם נוכל לראות את כתובת ה IP של שרת ה DNS, ואכן לראות שהוא לא מדויק (במקרה שלי, צרפת) (אם תשימו לב בטרמינל, תראו שאנו משתמשים ב D-chain ועוברים דרך כמה כתובת IP, מחלקן אנו מקבלים denied ומחלקן OK).
